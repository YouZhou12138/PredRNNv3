Architecture: "PredFormer"

Seed: 1234

Setting: moving_mnist

Logger:
    save_dir: "experiments/"

ckpt_path: None

Checkpointer:
    save_top_k: 1
    save_last: True
    every_n_epochs: 1

Trainer:
#    strategy: 'ddp'
    accelerator: 'gpu'
    log_every_n_steps: 64
    devices: [0]  # 改动
    max_epochs: 2000
    gradient_clip_val: 1

Data:
    val_batch_size: 16
    test_batch_size: 16
    train_batch_size: 16
    num_workers: 4

Task:
    loss:
        name: "MSE"

    context_length: 10
    target_length: 10
    n_stochastic_preds: 1
    metric: "MSE"
    optimization:
        optimizer:
            - name: AdamW
              args:
                  betas: [ 0.9, 0.999 ]
              lr_per_sample: 0.00000625
        lr_shedule:
            - name: Cosine
              args:
                  t_initial: 2000 #[2, 20, 50, 90]
                  lr_min: 0.000001

    n_log_batches: 2


Model:
    patch_size: 8
    num_channels: 1
    pre_seq: 10
    height: 64
    width: 64
    dim: 256
    dim_head: 32
    scale_dim: 4
    heads: 8
    dropout: 0.0
    attn_dropout: 0.0
    drop_path: 0.0
    depth: 1
    Ndepth: 12





